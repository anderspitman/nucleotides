- datasets.group_by{|i| i[:metadata][:library_id]}.each do |(data_set, values)|
  %div{:class => "panel panel-default"}
    .panel-heading
      %b= 'Read Set ' + data_id(data_set)
      %p
        %small= data_description data_set
    %table{:class => "table table-condensed tablesorter score"}
      %thead
        %tr
          %th{:class => "text-left col-md-2"}
            Assembler Image
          %th{:class => "text-left col-md-1"}
            Command Bundle
          %th{:class => "text-right col-md-1"}
            NG50
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            LG50
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            \#contigs
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            UN
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            IB
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            CPU Hrs
            %span{:class => "glyphicon glyphicon-sort"}
          %th{:class => "text-right col-md-1"}
            Memory Usage (Gb)
            %span{:class => "glyphicon glyphicon-sort"}
      %tbody
        - values.select{|i| i[:summary_metrics][:ng50]}.each do |value|
          %tr
            %td.text-left
              %a{href: link_to_assembler(value.metadata.image)}
                = value.metadata.image
            %td.text-left= value.metadata.prc
            %td.text-right= value.summary_metrics.ng50
            %td.text-right= value.summary_metrics.lg50
            %td.text-right= value.summary_metrics.n_contigs_gt_1000
            %td.text-right= value.summary_metrics.genome_fraction
            %td.text-right= value.summary_metrics.incorrect_per_100k
            %td.text-right= value.summary_metrics.total_cpu_hours
            %td.text-right= value.summary_metrics.max_memory_gbytes
